This code works in the epic branch.

I'm going to (?) rewrite it all using DurVec instead of Epic.
